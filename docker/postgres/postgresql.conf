# PostgreSQL Configuration for Portfolio Application
# This file is mounted into the PostgreSQL container

# =============================================================================
# QUERY LOGGING - For security monitoring and debugging
# =============================================================================

# What to log
log_statement = 'mod'                    # Log INSERT/UPDATE/DELETE/TRUNCATE
log_duration = on                        # Log duration of completed statements
log_min_duration_statement = 1000        # Log queries taking > 1 second (slow query log)

# Log format
log_line_prefix = '%t [%p] %u@%d %a '   # timestamp [pid] user@database application_name

# Connection logging
log_connections = on                     # Log connection attempts
log_disconnections = on                  # Log disconnections

# Security and debugging
log_lock_waits = on                      # Log when session waits longer than deadlock_timeout
log_checkpoints = on                     # Log checkpoint activity
log_autovacuum_min_duration = 0          # Log all autovacuum activity

# =============================================================================
# QUERY STATISTICS - pg_stat_statements extension
# =============================================================================

shared_preload_libraries = 'pg_stat_statements'
pg_stat_statements.track = 'all'         # Track all statements
pg_stat_statements.max = 10000           # Track up to 10000 distinct queries

# =============================================================================
# NOTES
# =============================================================================
# - Logs are written to container stdout/stderr (viewable with docker logs)
# - For production, consider log rotation with a syslog service
# - Adjust log_min_duration_statement based on your performance requirements
# - To change log_statement to 'all' (log all queries including SELECTs),
#   be prepared for large log volumes
