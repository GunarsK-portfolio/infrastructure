# ============================================================================
# PORTFOLIO INFRASTRUCTURE ENVIRONMENT VARIABLES
# ============================================================================
#
# IMPORTANT: This is an example file. To generate secure credentials:
#   1. Run: task generate-secrets
#   2. Or run: python3 scripts/generate-secrets.py
#
# The script will create a .env file with randomly generated passwords.
# DO NOT use these default passwords in any environment!
# ============================================================================

# Database
DB_HOST=postgres
DB_PORT=5432
# SSL Mode: disable (local Docker), require (AWS RDS), verify-ca, verify-full
# Valid values: disable, allow, prefer, require, verify-ca, verify-full
DB_SSLMODE=disable
POSTGRES_DB=portfolio

# PostgreSQL Superuser (for database creation)
# AUTO-GENERATED: Run 'task generate-secrets' to create secure password
POSTGRES_SUPERUSER=postgres
POSTGRES_SUPERUSER_PASSWORD=postgres_pass

# Flyway Migration User (DDL rights - creates/alters tables)
# AUTO-GENERATED: Run 'task generate-secrets' to create secure password
FLYWAY_USER=portfolio_owner
FLYWAY_PASSWORD=portfolio_owner_dev_pass
FLYWAY_BASELINE_ON_MIGRATE=true
FLYWAY_LOCATIONS=filesystem:/flyway/sql,filesystem:/flyway/seeds

# Admin API User (CRUD rights - used by services)
# AUTO-GENERATED: Run 'task generate-secrets' to create secure password
DB_USER=portfolio_admin
DB_PASSWORD=portfolio_admin_dev_pass

# Read-Only User (SELECT only - used by public API)
# AUTO-GENERATED: Run 'task generate-secrets' to create secure password
DB_USER_READONLY=portfolio_public
DB_PASSWORD_READONLY=portfolio_public_dev_pass

# Messaging User (CRUD on messaging schema only - used by messaging-api)
# AUTO-GENERATED: Run 'task generate-secrets' to create secure password
DB_USER_MESSAGING=portfolio_messaging
DB_PASSWORD_MESSAGING=portfolio_messaging_dev_pass

# Redis
# Note: Password is optional - leave empty for no authentication (development only)
# AUTO-GENERATED: Run 'task generate-secrets' to create secure password
# TLS encryption is automatically enabled in production (ENVIRONMENT=production)
REDIS_HOST=redis
REDIS_PORT=6379
REDIS_PASSWORD=redis_dev_pass

# RabbitMQ Message Broker
# AUTO-GENERATED: Run 'task generate-secrets' to create secure password
RABBITMQ_EXCHANGE=contact_messages
RABBITMQ_HOST=rabbitmq
RABBITMQ_PASSWORD=rabbitmq_dev_pass
RABBITMQ_PORT=5672
RABBITMQ_TLS=false
RABBITMQ_QUEUE=contact_messages
RABBITMQ_RETRY_DELAYS=1m,5m,30m,2h,12h
RABBITMQ_USER=rabbitmq
RABBITMQ_PREFETCH_COUNT=1
RABBITMQ_CONSUMER_TAG=messaging-service

# AWS / LocalStack
# For local development with LocalStack, any values work (not validated)
# For production, these are provided via IAM roles - leave empty
AWS_ACCESS_KEY_ID=test
AWS_REGION=eu-north-1
AWS_SECRET_ACCESS_KEY=test
SES_ENDPOINT=http://localstack:4566
SES_FROM_EMAIL=noreply@example.com

# MinIO (S3-compatible storage)
# Root user for MinIO administration
# AUTO-GENERATED: Run 'task generate-secrets' to create secure password
MINIO_ROOT_USER=minioadmin
MINIO_ROOT_PASSWORD=minioadmin_dev_pass

# Service account for files-api (limited to bucket operations only)
# AUTO-GENERATED: Run 'task generate-secrets' to create secure password
S3_ACCESS_KEY=files-api-user
S3_SECRET_KEY=files-api-secret-change-in-production

S3_DOCUMENTS_BUCKET=documents
S3_ENDPOINT=http://minio:9000
S3_IMAGES_BUCKET=images
S3_MINIATURES_BUCKET=miniatures
S3_USE_SSL=false

# JWT Authentication
# AUTO-GENERATED: Run 'task generate-secrets' to create secure secret
JWT_SECRET=your-secret-key-change-in-production
JWT_ACCESS_EXPIRY=15m
JWT_REFRESH_EXPIRY=168h

# Cookie Configuration (auth-service)
# COOKIE_DOMAIN: Set to ".yourdomain.com" for production, empty for localhost
# COOKIE_SECURE: true for HTTPS (production), false for HTTP (development)
# COOKIE_SAMESITE: Strict (production), Lax (development)
COOKIE_DOMAIN=
COOKIE_SECURE=false
COOKIE_SAMESITE=Lax

# SSL/TLS Certificates
# For local development with self-signed certs
TRAEFIK_CERT_DIR=./docker/traefik/certs
TLS_CERT_FILE=localhost.crt
TLS_KEY_FILE=localhost.key

# Environment
ENVIRONMENT=development

# Logging Configuration (for all Go services)
# LOG_LEVEL: debug (verbose), info (normal), warn (warnings only), error (errors only)
# LOG_FORMAT: json (for Loki/production), text (human-readable for development)
# LOG_SOURCE: true (add file:line to logs, dev only), false (production)
LOG_LEVEL=info
LOG_FORMAT=json
LOG_SOURCE=false

# Service Ports
AUTH_SERVICE_PORT=8084
PUBLIC_API_PORT=8082
ADMIN_API_PORT=8083
FILES_API_PORT=8085
MESSAGING_API_PORT=8086
MESSAGING_SERVICE_PORT=8087

# Swagger Documentation (development only - leave empty in production)
# Access via http://localhost:82/{service}/swagger/index.html
SWAGGER_HOST_ADMIN=localhost:82/admin
SWAGGER_HOST_AUTH=localhost:82/auth
SWAGGER_HOST_FILES=localhost:82/files
SWAGGER_HOST_MESSAGING=localhost:82/messaging
SWAGGER_HOST_PUBLIC=localhost:82/public

# Files API for URL generation
FILES_API_URL=https://localhost:8443/files-api/v1

# File Upload Configuration
MAX_FILE_SIZE=10485760
ALLOWED_FILE_TYPES=image/jpeg,image/jpg,image/png,image/gif,image/webp,application/pdf,application/vnd.openxmlformats-officedocument.wordprocessingml.document,application/msword

# Web Frontend
# Public Web
VITE_PUBLIC_API_URL=https://localhost/api/v1
VITE_PUBLIC_MESSAGE_API_URL=https://localhost/message/v1
VITE_PUBLIC_USE_MOCK_DATA=true

# Admin Web
VITE_ADMIN_API_URL=https://localhost:8443/admin-api/v1
VITE_ADMIN_AUTH_URL=https://localhost:8443/auth/v1
VITE_ADMIN_FILES_API_URL=https://localhost:8443/files-api/v1
VITE_ADMIN_MESSAGING_API_URL=https://localhost:8443/messaging-api/v1

# Monitoring (Optional - for docker-compose.monitoring.yml)
# WARNING: Default credentials are INSECURE and must be changed before ANY non-local deployment
# These credentials MUST be changed - they will cause startup failure if not set in .env
GRAFANA_ADMIN_PASSWORD=admin
GRAFANA_ADMIN_USER=admin

# CORS - Allowed origins for each service (REQUIRED for security)
# Admin services (accessed from admin-web at https://localhost:8443 and e2e tests at http://localhost:81)
ALLOWED_ORIGINS_ADMIN=https://localhost:8443,http://localhost:81
ALLOWED_ORIGINS_AUTH=https://localhost:8443,http://localhost:81
# Files API (accessed from admin-web, public-web, and e2e tests)
ALLOWED_ORIGINS_FILES=https://localhost:8443,https://localhost,http://localhost:81,http://localhost:80
# Public API (accessed from public-web at https://localhost and e2e tests at http://localhost:80)
ALLOWED_ORIGINS_PUBLIC=https://localhost,http://localhost:80
# Messaging API (accessed from public-web and admin-web)
ALLOWED_ORIGINS_MESSAGING=https://localhost,https://localhost:8443,http://localhost:80,http://localhost:81
